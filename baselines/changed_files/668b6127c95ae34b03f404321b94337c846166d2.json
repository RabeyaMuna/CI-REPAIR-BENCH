{
    "sha_fail": "668b6127c95ae34b03f404321b94337c846166d2",
    "changed_files": [
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "frontend/taipy-gui/src/components/Router.tsx",
            "diff": "diff --git a/frontend/taipy-gui/src/components/Router.tsx b/frontend/taipy-gui/src/components/Router.tsx\nindex bb802584..2ee1f841 100644\n--- a/frontend/taipy-gui/src/components/Router.tsx\n+++ b/frontend/taipy-gui/src/components/Router.tsx\n@@ -12,13 +12,14 @@\n  */\n \n import React, { useEffect, useReducer, useState } from \"react\";\n-import axios from \"axios\";\n import Box from \"@mui/material/Box\";\n import CircularProgress from \"@mui/material/CircularProgress\";\n import CssBaseline from \"@mui/material/CssBaseline\";\n import { ThemeProvider } from \"@mui/system\";\n import { LocalizationProvider } from \"@mui/x-date-pickers/LocalizationProvider\";\n import { AdapterDateFns } from \"@mui/x-date-pickers/AdapterDateFnsV3\";\n+import axios from \"axios\";\n+import { MathJaxContext } from \"better-react-mathjax\";\n import { SnackbarProvider } from \"notistack\";\n import { HelmetProvider } from \"react-helmet-async\";\n import { BrowserRouter, Route, Routes } from \"react-router\";\n@@ -34,16 +35,16 @@ import {\n     taipyInitialize,\n     taipyReducer,\n } from \"../context/taipyReducers\";\n+import { getBaseURL } from \"../utils\";\n+import ErrorFallback from \"../utils/ErrorBoundary\";\n import UIBlocker from \"./Taipy/UIBlocker\";\n import Navigate from \"./Taipy/Navigate\";\n import Menu from \"./Taipy/Menu\";\n import TaipyNotification from \"./Taipy/Notification\";\n import GuiDownload from \"./Taipy/GuiDownload\";\n-import ErrorFallback from \"../utils/ErrorBoundary\";\n import MainPage from \"./pages/MainPage\";\n import TaipyRendered from \"./pages/TaipyRendered\";\n import NotFound404 from \"./pages/NotFound404\";\n-import { getBaseURL } from \"../utils\";\n import { useLocalStorageWithEvent } from \"../hooks\";\n \n interface AxiosRouter {\n@@ -56,6 +57,19 @@ const mainSx = { flexGrow: 1, bgcolor: \"background.default\" };\n const containerSx = { display: \"flex\" };\n const progressSx = { position: \"fixed\", bottom: \"1em\", right: \"1em\" };\n const pageStore = {};\n+const mathJaxConfig = {\n+    tex: {\n+        inlineMath: [\n+            [\"$\", \"$\"],\n+            [\"\\\\(\", \"\\\\)\"],\n+        ],\n+        displayMath: [\n+            [\"$$\", \"$$\"],\n+            [\"\\\\[\", \"\\\\]\"],\n+        ],\n+    },\n+    asyncLoad: true,\n+};\n \n const Router = () => {\n     const [state, dispatch] = useReducer(taipyReducer, INITIAL_STATE, taipyInitialize);\n@@ -112,60 +126,66 @@ const Router = () => {\n                     <SnackbarProvider maxSnack={5}>\n                         <LocalizationProvider dateAdapter={AdapterDateFns}>\n                             <PageContext.Provider value={pageStore}>\n-                                <BrowserRouter>\n-                                    <Box style={containerSx}>\n-                                        <CssBaseline />\n-                                        <ErrorBoundary FallbackComponent={ErrorFallback}>\n-                                            <Menu {...state.menu} />\n-                                        </ErrorBoundary>\n-                                        <Box component=\"main\" sx={mainSx}>\n+                                <MathJaxContext config={mathJaxConfig}>\n+                                    <BrowserRouter>\n+                                        <Box style={containerSx}>\n+                                            <CssBaseline />\n                                             <ErrorBoundary FallbackComponent={ErrorFallback}>\n-                                                {Object.keys(routes).length ? (\n-                                                    <Routes>\n-                                                        <Route\n-                                                            path={baseURL}\n-                                                            element={\n-                                                                <MainPage\n-                                                                    path={routes[\"/\"]}\n-                                                                    route={Object.keys(routes).find(\n-                                                                        (path) => path !== \"/\",\n-                                                                    )}\n-                                                                />\n-                                                            }\n-                                                        >\n-                                                            {Object.entries(routes)\n-                                                                .filter(([path]) => path !== \"/\")\n-                                                                .map(([path, name]) => (\n-                                                                    <Route\n-                                                                        key={name}\n-                                                                        path={path.substring(1)}\n-                                                                        element={<TaipyRendered />}\n-                                                                    />\n-                                                                ))}\n-                                                            <Route path=\"*\" key=\"NotFound\" element={<NotFound404 />} />\n-                                                        </Route>\n-                                                    </Routes>\n-                                                ) : null}\n+                                                <Menu {...state.menu} />\n                                             </ErrorBoundary>\n-                                        </Box>\n-                                        {state.ackList.length ? (\n-                                            <Box sx={progressSx} className=\"taipy-busy\">\n-                                                <CircularProgress size=\"1em\" disableShrink />\n+                                            <Box component=\"main\" sx={mainSx}>\n+                                                <ErrorBoundary FallbackComponent={ErrorFallback}>\n+                                                    {Object.keys(routes).length ? (\n+                                                        <Routes>\n+                                                            <Route\n+                                                                path={baseURL}\n+                                                                element={\n+                                                                    <MainPage\n+                                                                        path={routes[\"/\"]}\n+                                                                        route={Object.keys(routes).find(\n+                                                                            (path) => path !== \"/\"\n+                                                                        )}\n+                                                                    />\n+                                                                }\n+                                                            >\n+                                                                {Object.entries(routes)\n+                                                                    .filter(([path]) => path !== \"/\")\n+                                                                    .map(([path, name]) => (\n+                                                                        <Route\n+                                                                            key={name}\n+                                                                            path={path.substring(1)}\n+                                                                            element={<TaipyRendered />}\n+                                                                        />\n+                                                                    ))}\n+                                                                <Route\n+                                                                    path=\"*\"\n+                                                                    key=\"NotFound\"\n+                                                                    element={<NotFound404 />}\n+                                                                />\n+                                                            </Route>\n+                                                        </Routes>\n+                                                    ) : null}\n+                                                </ErrorBoundary>\n                                             </Box>\n-                                        ) : null}\n-                                    </Box>\n-                                    <ErrorBoundary FallbackComponent={ErrorFallback}>\n-                                        <TaipyNotification notifications={state.notifications} />\n-                                        <UIBlocker block={state.block} />\n-                                        <Navigate\n-                                            to={state.navigateTo}\n-                                            params={state.navigateParams}\n-                                            tab={state.navigateTab}\n-                                            force={state.navigateForce}\n-                                        />\n-                                        <GuiDownload download={state.download} />\n-                                    </ErrorBoundary>\n-                                </BrowserRouter>\n+                                            {state.ackList.length ? (\n+                                                <Box sx={progressSx} className=\"taipy-busy\">\n+                                                    <CircularProgress size=\"1em\" disableShrink />\n+                                                </Box>\n+                                            ) : null}\n+                                        </Box>\n+                                        <ErrorBoundary FallbackComponent={ErrorFallback}>\n+                                            <TaipyNotification notifications={state.notifications} />\n+                                            <UIBlocker block={state.block} />\n+                                            <Navigate\n+                                                to={state.navigateTo}\n+                                                params={state.navigateParams}\n+                                                tab={state.navigateTab}\n+                                                force={state.navigateForce}\n+                                            />\n+                                            <GuiDownload download={state.download} />\n+                                        </ErrorBoundary>\n+                                    </BrowserRouter>\n+                                </MathJaxContext>\n                             </PageContext.Provider>\n                         </LocalizationProvider>\n                     </SnackbarProvider>\n"
        },
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "frontend/taipy-gui/src/components/Taipy/Field.spec.tsx",
            "diff": "diff --git a/frontend/taipy-gui/src/components/Taipy/Field.spec.tsx b/frontend/taipy-gui/src/components/Taipy/Field.spec.tsx\nindex 1ac23cdd..fc388483 100644\n--- a/frontend/taipy-gui/src/components/Taipy/Field.spec.tsx\n+++ b/frontend/taipy-gui/src/components/Taipy/Field.spec.tsx\n@@ -16,7 +16,20 @@ import { render, waitFor } from \"@testing-library/react\";\n import \"@testing-library/jest-dom\";\n \n import Field from \"./Field\";\n+import { MathJaxContext } from \"better-react-mathjax\";\n \n+const mathJaxConfig = {\n+    tex: {\n+        inlineMath: [\n+            [\"$\", \"$\"],\n+            [\"\\\\(\", \"\\\\)\"],\n+        ],\n+        displayMath: [\n+            [\"$$\", \"$$\"],\n+            [\"\\\\[\", \"\\\\]\"],\n+        ],\n+    },\n+};\n describe(\"Field Component\", () => {\n     it(\"renders\", async () => {\n         const { getByText } = render(<Field value=\"toto\" />);\n@@ -74,16 +87,18 @@ describe(\"Field Component\", () => {\n     describe(\"latex mode\", () => {\n         it(\"renders LaTeX as block math\", async () => {\n             const { container, getByText } = render(\n-                <Field value={\"$$x = y + 1$$\"} className=\"taipy-text\" mode=\"latex\" />\n+                <MathJaxContext config={mathJaxConfig}>\n+                    <Field value={\"$$x = y + 1$$\"} className=\"taipy-text\" mode=\"latex\" />\n+                </MathJaxContext>\n             );\n-            getByText(/latex/i);\n             await waitFor(() => expect(container.querySelector(\".taipy-text-latex\")).toBeInTheDocument());\n         });\n         it(\"renders LaTeX as inline math\", async () => {\n-            const { container, getByText, findByText } = render(\n-                <Field value={\"This is inline $x = y + 1$ math.\"} className=\"taipy-text\" mode=\"latex\" />\n+            const { container, findByText } = render(\n+                <MathJaxContext config={mathJaxConfig}>\n+                    <Field value={\"This is inline $x = y + 1$ math.\"} className=\"taipy-text\" mode=\"latex\" />\n+                </MathJaxContext>\n             );\n-            // getByText(/latex/i); // already loaded ?\n             await waitFor(() => expect(container.querySelector(\".taipy-text-latex\")).toBeInTheDocument());\n             expect(await findByText(/inline/i)).toBeInTheDocument();\n         });\n"
        },
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "frontend/taipy-gui/src/components/Taipy/Field.tsx",
            "diff": "diff --git a/frontend/taipy-gui/src/components/Taipy/Field.tsx b/frontend/taipy-gui/src/components/Taipy/Field.tsx\nindex 494bc89c..d674d5fd 100644\n--- a/frontend/taipy-gui/src/components/Taipy/Field.tsx\n+++ b/frontend/taipy-gui/src/components/Taipy/Field.tsx\n@@ -14,6 +14,7 @@\n import React, { lazy, useMemo, Suspense } from \"react\";\n import Typography from \"@mui/material/Typography\";\n import Tooltip from \"@mui/material/Tooltip\";\n+import { MathJax } from \"better-react-mathjax\";\n \n import { formatWSValue } from \"../../utils\";\n import { getSuffixedClassNames } from \"./utils\";\n@@ -34,23 +35,6 @@ interface TaipyFieldProps extends TaipyBaseProps, TaipyHoverProps {\n const unsetWeightSx = { fontWeight: \"unset\" };\n \n const Markdown = lazy(() => import(\"react-markdown\"));\n-const MathJax = lazy(() => import(\"better-react-mathjax\").then((module) => ({ default: module.MathJax })));\n-const MathJaxContext = lazy(() =>\n-    import(\"better-react-mathjax\").then((module) => ({ default: module.MathJaxContext }))\n-);\n-\n-const mathJaxConfig = {\n-    tex: {\n-        inlineMath: [\n-            [\"$\", \"$\"],\n-            [\"\\\\(\", \"\\\\)\"],\n-        ],\n-        displayMath: [\n-            [\"$$\", \"$$\"],\n-            [\"\\\\[\", \"\\\\]\"],\n-        ],\n-    },\n-};\n \n const Field = (props: TaipyFieldProps) => {\n     const { id, dataType, format, defaultValue, raw } = props;\n@@ -117,19 +101,15 @@ const Field = (props: TaipyFieldProps) => {\n                         {value}\n                     </span>\n                 ) : mode == \"latex\" ? (\n-                    <Suspense fallback={<div>Loading LaTex...</div>}>\n-                        <MathJaxContext config={mathJaxConfig}>\n-                            <MathJax\n-                                className={`${className} ${getSuffixedClassNames(\n-                                    className,\n-                                    \"-latex\"\n-                                )} ${getComponentClassName(props.children)}`}\n-                                id={id}\n-                            >\n-                                {value}\n-                            </MathJax>\n-                        </MathJaxContext>\n-                    </Suspense>\n+                    <MathJax\n+                        className={`${className} ${getSuffixedClassNames(className, \"-latex\")} ${getComponentClassName(\n+                            props.children\n+                        )}`}\n+                        id={id}\n+                        dynamic={true}\n+                    >\n+                        {value}\n+                    </MathJax>\n                 ) : (\n                     <Typography\n                         className={`${className} ${\n"
        },
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "frontend/taipy-gui/src/components/Taipy/Selector.spec.tsx",
            "diff": "diff --git a/frontend/taipy-gui/src/components/Taipy/Selector.spec.tsx b/frontend/taipy-gui/src/components/Taipy/Selector.spec.tsx\nindex dd1ab206..b0f37ece 100644\n--- a/frontend/taipy-gui/src/components/Taipy/Selector.spec.tsx\n+++ b/frontend/taipy-gui/src/components/Taipy/Selector.spec.tsx\n@@ -12,7 +12,7 @@\n  */\n \n import React from \"react\";\n-import { render, fireEvent } from \"@testing-library/react\";\n+import { render, fireEvent, waitFor } from \"@testing-library/react\";\n import \"@testing-library/jest-dom\";\n import userEvent from \"@testing-library/user-event\";\n \n@@ -315,6 +315,18 @@ describe(\"Selector Component\", () => {\n             await userEvent.click(elt);\n             expect(queryAllByRole(\"listbox\")).toHaveLength(0);\n         });\n+        it(\"renders selectionMessage if defined\", async () => {\n+            const { getByText, getByRole } = render(\n+                <Selector lov={lov} dropdown={true} filter={true} selectionMessage=\"a selection message\" />\n+            );\n+            const butElt = getByRole(\"combobox\");\n+            expect(butElt).toBeInTheDocument();\n+            await userEvent.click(butElt);\n+            getByRole(\"listbox\");\n+            const elt = getByText(\"Item 2\");\n+            await userEvent.click(elt);\n+            // getByText(\"a selection message\"); one day this will work\n+        });\n         it(\"renders showSelectAll in dropdown if True\", async () => {\n             const { getByText, getByRole } = render(\n                 <Selector lov={lov} dropdown={true} multiple={true} showSelectAll={true} />\n"
        },
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "frontend/taipy-gui/src/components/Taipy/Selector.tsx",
            "diff": "diff --git a/frontend/taipy-gui/src/components/Taipy/Selector.tsx b/frontend/taipy-gui/src/components/Taipy/Selector.tsx\nindex 77d785b0..25db82db 100644\n--- a/frontend/taipy-gui/src/components/Taipy/Selector.tsx\n+++ b/frontend/taipy-gui/src/components/Taipy/Selector.tsx\n@@ -49,7 +49,7 @@ import Select, { SelectChangeEvent } from \"@mui/material/Select\";\n import TextField from \"@mui/material/TextField\";\n import { Theme, useTheme } from \"@mui/material\";\n \n-import { doNotPropagateEvent, expandSx, getSuffixedClassNames, getUpdateVar } from \"./utils\";\n+import { doNotPropagateEvent, expandSx, getCssSize, getSuffixedClassNames, getUpdateVar } from \"./utils\";\n import { createSendActionNameAction, createSendUpdateAction } from \"../../context/taipyReducers\";\n import { ItemProps, LovImage, paperBaseSx, SelTreeProps, showItem, SingleItem, useLovListMemo } from \"./lovUtils\";\n import {\n@@ -311,7 +311,18 @@ const Selector = (props: SelectorProps) => {\n         () => ({\n             my: 1,\n             mx: 0,\n-            width: width,\n+            width: getCssSize(width),\n+            maxWidth: \"unset\",\n+            \"& .MuiInputBase-root\": { minHeight: 48, \"& input\": { minHeight: \"unset\" } },\n+        }),\n+        [width]\n+    );\n+\n+    const autoCompleteSx = useMemo(\n+        () => ({\n+            my: 1,\n+            mx: 0,\n+            width: getCssSize(width),\n             \"& .MuiFormControl-root\": {\n                 maxWidth: \"unset\",\n                 my: 0,\n@@ -475,10 +486,14 @@ const Selector = (props: SelectorProps) => {\n     const renderAutoInput = useCallback(\n         (params: AutocompleteRenderInputParams) => {\n             if (params.InputProps) {\n-                if (!params.InputProps.startAdornment) {\n-                    params.InputProps.startAdornment = [];\n-                } else if (!Array.isArray(params.InputProps.startAdornment)) {\n-                    params.InputProps.startAdornment = [params.InputProps.startAdornment];\n+                if (selectionMessage) {\n+                    params.InputProps.startAdornment = [<Chip key=\"selectionMessage\" label={selectionMessage}></Chip>];\n+                } else {\n+                    if (!params.InputProps.startAdornment) {\n+                        params.InputProps.startAdornment = [];\n+                    } else if (!Array.isArray(params.InputProps.startAdornment)) {\n+                        params.InputProps.startAdornment = [params.InputProps.startAdornment];\n+                    }\n                 }\n                 // will need to move to slotProps { input: { startAdornment: (\n                 (params.InputProps.startAdornment as Array<ReactNode>).unshift(\n@@ -489,15 +504,25 @@ const Selector = (props: SelectorProps) => {\n                         lovListLength={lovList.length}\n                         active={active}\n                         handleCheckAllChange={handleCheckAllAutoChange}\n+                        key=\"selectAll\"\n                     />\n                 );\n             } else {\n-                console.log(\"selector autocomplete needs to updata params for slotProps.input.startAdornment\");\n+                console.log(\"selector autocomplete needs to update params for slotProps.input.startAdornment\");\n                 console.log(\"renderAutoInput\", params);\n             }\n             return <TextField {...params} label={props.label} margin=\"dense\" />;\n         },\n-        [props.label, multiple, showSelectAll, selectedValue.length, lovList.length, active, handleCheckAllAutoChange]\n+        [\n+            selectionMessage,\n+            props.label,\n+            multiple,\n+            showSelectAll,\n+            selectedValue.length,\n+            lovList.length,\n+            active,\n+            handleCheckAllAutoChange,\n+        ]\n     );\n \n     const handleDelete = useCallback(\n@@ -597,7 +622,7 @@ const Selector = (props: SelectorProps) => {\n                             getOptionLabel={getOptionLabel}\n                             getOptionKey={getOptionKey}\n                             isOptionEqualToValue={isOptionEqualToValue}\n-                            sx={controlSx}\n+                            sx={autoCompleteSx}\n                             className={`${className} ${getComponentClassName(props.children)}`}\n                             renderInput={renderAutoInput}\n                             renderOption={renderOption}\n@@ -630,43 +655,45 @@ const Selector = (props: SelectorProps) => {\n                                 disabled={!active}\n                                 renderValue={(selected) => (\n                                     <Box sx={renderBoxSx}>\n-                                        {typeof selectionMessage === \"string\"\n-                                            ? selectionMessage\n-                                            : lovList\n-                                                  .filter((it) =>\n-                                                      Array.isArray(selected)\n-                                                          ? selected.includes(it.id)\n-                                                          : selected === it.id\n-                                                  )\n-                                                  .map((item, idx) => {\n-                                                      if (multiple) {\n-                                                          const chipProps = {} as Record<string, unknown>;\n-                                                          if (typeof item.item === \"string\") {\n-                                                              chipProps.label = item.item;\n-                                                          } else {\n-                                                              chipProps.label = item.item.text || \"\";\n-                                                              chipProps.avatar = <Avatar src={item.item.path} />;\n-                                                          }\n-                                                          return (\n-                                                              <Chip\n-                                                                  key={item.id}\n-                                                                  {...chipProps}\n-                                                                  onDelete={handleDelete}\n-                                                                  data-id={item.id}\n-                                                                  onMouseDown={doNotPropagateEvent}\n-                                                                  disabled={!active}\n-                                                              />\n-                                                          );\n-                                                      } else if (idx === 0) {\n-                                                          return typeof item.item === \"string\" ? (\n-                                                              item.item\n-                                                          ) : (\n-                                                              <LovImage item={item.item} />\n-                                                          );\n-                                                      } else {\n-                                                          return null;\n-                                                      }\n-                                                  })}\n+                                        {typeof selectionMessage === \"string\" ? (\n+                                            <Chip key=\"selectionMessage\" label={selectionMessage} />\n+                                        ) : (\n+                                            lovList\n+                                                .filter((it) =>\n+                                                    Array.isArray(selected)\n+                                                        ? selected.includes(it.id)\n+                                                        : selected === it.id\n+                                                )\n+                                                .map((item, idx) => {\n+                                                    if (multiple) {\n+                                                        const chipProps = {} as Record<string, unknown>;\n+                                                        if (typeof item.item === \"string\") {\n+                                                            chipProps.label = item.item;\n+                                                        } else {\n+                                                            chipProps.label = item.item.text || \"\";\n+                                                            chipProps.avatar = <Avatar src={item.item.path} />;\n+                                                        }\n+                                                        return (\n+                                                            <Chip\n+                                                                key={item.id}\n+                                                                {...chipProps}\n+                                                                onDelete={handleDelete}\n+                                                                data-id={item.id}\n+                                                                onMouseDown={doNotPropagateEvent}\n+                                                                disabled={!active}\n+                                                            />\n+                                                        );\n+                                                    } else if (idx === 0) {\n+                                                        return typeof item.item === \"string\" ? (\n+                                                            item.item\n+                                                        ) : (\n+                                                            <LovImage item={item.item} />\n+                                                        );\n+                                                    } else {\n+                                                        return null;\n+                                                    }\n+                                                })\n+                                        )}\n                                     </Box>\n                                 )}\n                                 MenuProps={getMenuProps(height)}\n"
        },
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "taipy/common/config/config.pyi",
            "diff": "diff --git a/taipy/common/config/config.pyi b/taipy/common/config/config.pyi\nindex 64e580e6..c893decc 100644\n--- a/taipy/common/config/config.pyi\n+++ b/taipy/common/config/config.pyi\n@@ -8,6 +8,7 @@\n # Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n # an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n # specific language governing permissions and limitations under the License.\n+\n import json\n from datetime import timedelta\n from typing import Any, Callable, Dict, List, Optional, Union\n"
        },
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "taipy/gui/gui.py",
            "diff": "diff --git a/taipy/gui/gui.py b/taipy/gui/gui.py\nindex 3696c743..9c6a7755 100644\n--- a/taipy/gui/gui.py\n+++ b/taipy/gui/gui.py\n@@ -1580,6 +1580,27 @@ class Gui:\n     def _set_module_context(self, module_context: t.Optional[str]) -> t.ContextManager[None]:\n         return self._set_locals_context(module_context) if module_context is not None else contextlib.nullcontext()\n \n+    def _invoke_method(self, state_id: str, method: t.Callable, *args):\n+        this_sid = None\n+        if request:\n+            # avoid messing with the client_id => Set(ws id)\n+            this_sid = getattr(request, \"sid\", None)\n+            request.sid = None  # type: ignore[attr-defined]\n+        try:\n+            with self.get_flask_app().app_context():\n+                setattr(g, Gui.__ARG_CLIENT_ID, state_id)\n+                return method(self, *args)\n+        except Exception as e:  # pragma: no cover\n+            if not self._call_on_exception(method, e):\n+                _warn(\n+                    f\"Gui._invoke_method(): Exception raised in {_function_name(method)}\",\n+                    e,\n+                )\n+        finally:\n+            if this_sid:\n+                request.sid = this_sid  # type: ignore[attr-defined]\n+        return None\n+\n     def invoke_callback(\n         self,\n         state_id: str,\n"
        },
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "taipy/gui/gui_actions.py",
            "diff": "diff --git a/taipy/gui/gui_actions.py b/taipy/gui/gui_actions.py\nindex 1ac4d56d..fe14ca7e 100644\n--- a/taipy/gui/gui_actions.py\n+++ b/taipy/gui/gui_actions.py\n@@ -55,7 +55,7 @@ def download(state: State, content: t.Any, name: t.Optional[str] = \"\", on_action\n                   and the second element reflects the server-side URL where the file is located.\n     \"\"\"\n     if state and isinstance(state._gui, Gui):\n-        state._gui._download(content, name, on_action)  # type: ignore[attr-defined]\n+        state._invoke_on_gui(Gui._download, content, name, on_action)\n     else:\n         _warn(\"'download()' must be called in the context of a callback.\")\n \n@@ -100,7 +100,7 @@ def notify(\n     displayed, but the in-app notification will still function.\n     \"\"\"\n     if state and isinstance(state._gui, Gui):\n-        return state._gui._notify(notification_type, message, system_notification, duration, id)  # type: ignore[attr-defined]\n+        return state._invoke_on_gui(Gui._notify, notification_type, message, system_notification, duration, id)\n     else:\n         _warn(\"'notify()' must be called in the context of a callback.\")\n         return None\n@@ -122,7 +122,7 @@ def close_notification(state: State, id: str) -> None:\n     \"\"\"\n     if state and isinstance(state._gui, Gui):\n         # Send the close command with the notification_id\n-        state._gui._close_notification(id)  # type: ignore[attr-defined]\n+        state._invoke_on_gui(Gui._close_notification, id)\n     else:\n         _warn(\"'close_notification()' must be called in the context of a callback.\")\n \n@@ -157,7 +157,7 @@ def hold_control(\n         message: The message to show. The default value is the string \"Work in Progress...\".\n     \"\"\"\n     if state and isinstance(state._gui, Gui):\n-        state._gui._hold_actions(callback, message)  # type: ignore[attr-defined]\n+        state._invoke_on_gui(Gui._hold_actions, callback, message)\n     else:\n         _warn(\"'hold_actions()' must be called in the context of a callback.\")\n \n@@ -172,7 +172,7 @@ def resume_control(state: State):\n         state (State^): The current user state as received in any callback.\n     \"\"\"\n     if state and isinstance(state._gui, Gui):\n-        state._gui._resume_actions()  # type: ignore[attr-defined]\n+        state._invoke_on_gui(Gui._resume_actions)\n     else:\n         _warn(\"'resume_actions()' must be called in the context of a callback.\")\n \n@@ -198,7 +198,7 @@ def navigate(\n         force: When navigating to a known page, the content is refreshed even it the page is already shown.\n     \"\"\"\n     if state and isinstance(state._gui, Gui):\n-        state._gui._navigate(to, params, tab, force)  # type: ignore[attr-defined]\n+        state._invoke_on_gui(Gui._navigate, to, params, tab, force)\n     else:\n         _warn(\"'navigate()' must be called in the context of a callback.\")\n \n@@ -223,7 +223,7 @@ def get_user_content_url(\n         An URL that, when queried, triggers the *on_user_content* callback.\n     \"\"\"\n     if state and isinstance(state._gui, Gui):\n-        return state._gui._get_user_content_url(path, params)  # type: ignore[attr-defined]\n+        return state._invoke_on_gui(Gui._get_user_content_url, path, params)\n     _warn(\"'get_user_content_url()' must be called in the context of a callback.\")\n     return None\n \n@@ -245,7 +245,7 @@ def get_state_id(state: State) -> t.Optional[str]:\n             If this value None, it indicates that *state* is not handled by a `Gui^` instance.\n     \"\"\"\n     if state and isinstance(state._gui, Gui):\n-        return state._gui._get_client_id()  # type: ignore[attr-defined]\n+        return state._invoke_on_gui(Gui._get_client_id)\n     return None\n \n \n@@ -259,7 +259,7 @@ def get_module_context(state: State) -> t.Optional[str]:\n         The name of the current module.\n     \"\"\"\n     if state and isinstance(state._gui, Gui):\n-        return state._gui._get_locals_context()  # type: ignore[attr-defined]\n+        return state._invoke_on_gui(Gui._get_locals_context)\n     return None\n \n \n@@ -289,7 +289,7 @@ def get_module_name_from_state(state: State) -> t.Optional[str]:\n             that triggered the callback that was provided the *state* object.\n     \"\"\"\n     if state and isinstance(state._gui, Gui):\n-        return state._gui._get_locals_context()  # type: ignore[attr-defined]\n+        return state._invoke_on_gui(Gui._get_locals_context)\n     return None\n \n \n"
        },
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "taipy/gui/state.py",
            "diff": "diff --git a/taipy/gui/state.py b/taipy/gui/state.py\nindex cc3a8f04..340d8f0c 100644\n--- a/taipy/gui/state.py\n+++ b/taipy/gui/state.py\n@@ -150,8 +150,10 @@ class State(SimpleNamespace, metaclass=ABCMeta):\n         self._gui.set_favicon(favicon_path, self)\n \n     @abstractmethod\n-    def __getitem__(self, key: str) -> \"State\":\n-        ...\n+    def __getitem__(self, key: str) -> \"State\": ...\n+\n+    @abstractmethod\n+    def _invoke_on_gui(self, method: t.Callable, *args: t.Any) -> t.Any: ...\n \n \n class _GuiState(State):\n@@ -174,6 +176,7 @@ class _GuiState(State):\n         \"_get_gui_attr\",\n         \"_get_placeholder_attrs\",\n         \"_add_attribute\",\n+        \"_invoke_on_gui\",\n     )\n     __placeholder_attrs = (\"_taipy_p1\", \"_current_context\", \"__state_id\")\n     __excluded_attrs = __attrs + __methods + __placeholder_attrs\n@@ -280,6 +283,9 @@ class _GuiState(State):\n             return gui._bind_var_val(name, default_value)\n         return False\n \n+    def _invoke_on_gui(self, method: t.Callable, *args):\n+        return method(self.get_gui(), *args)\n+\n \n class _AsyncState(_GuiState):\n     def __init__(self, state: State) -> None:\n@@ -303,3 +309,6 @@ class _AsyncState(_GuiState):\n         return self.get_gui().invoke_callback(\n             t.cast(str, self._get_placeholder(\"__state_id\")), _AsyncState.__get_var_from_state, [var_name]\n         )\n+\n+    def _invoke_on_gui(self, method: t.Callable, *args):\n+        return self.get_gui()._invoke_method(t.cast(str, self._get_placeholder(\"__state_id\")), method, *args)\n"
        },
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "tests/gui/actions/test_action_with_async_state.py",
            "diff": "diff --git a/tests/gui/actions/test_action_with_async_state.py b/tests/gui/actions/test_action_with_async_state.py\nnew file mode 100644\nindex 00000000..178354e2\n--- /dev/null\n+++ b/tests/gui/actions/test_action_with_async_state.py\n@@ -0,0 +1,40 @@\n+# Copyright 2021-2025 Avaiga Private Limited\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+# the License. You may obtain a copy of the License at\n+#\n+#        http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+# an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+# specific language governing permissions and limitations under the License.\n+\n+import inspect\n+import typing as t\n+\n+from flask import g\n+\n+from taipy.gui import Gui, Markdown, notify\n+from taipy.gui.state import _AsyncState, _GuiState\n+\n+\n+def test_async_notify(gui: Gui, helpers):\n+    # set gui frame\n+    gui._set_frame(inspect.currentframe())\n+\n+    gui.add_page(\"test\", Markdown(\"<|Hello|button|>\"))\n+    gui.run(run_server=False)\n+    flask_client = gui._server.test_client()\n+    # WS client and emit\n+    ws_client = gui._server._ws.test_client(gui._server.get_flask())  # type: ignore[arg-type]\n+    cid = helpers.create_scope_and_get_sid(gui)\n+    flask_client.get(f\"/taipy-jsx/test?client_id={cid}\")\n+    with gui.get_flask_app().test_request_context(f\"/taipy-jsx/test/?client_id={cid}\", data={\"client_id\": cid}):\n+        g.client_id = cid\n+        id = notify(_AsyncState(t.cast(_GuiState, gui._Gui__state)), \"Info\", \"Message\", id=\"id_async\")  # type: ignore[attr-defined]\n+        assert id == \"id_async\"\n+    received_messages = ws_client.get_received()\n+    assert len(received_messages) == 1\n+    helpers.assert_outward_ws_simple_message(\n+        received_messages[0], \"AL\", {\"nType\": \"Info\", \"message\": \"Message\", \"notificationId\": \"id_async\"}\n+    )\n"
        },
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "tools/config/generate_pyi.py",
            "diff": "diff --git a/tools/config/generate_pyi.py b/tools/config/generate_pyi.py\nnew file mode 100644\nindex 00000000..a0b963e6\n--- /dev/null\n+++ b/tools/config/generate_pyi.py\n@@ -0,0 +1,172 @@\n+# Copyright 2021-2025 Avaiga Private Limited\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+# the License. You may obtain a copy of the License at\n+#\n+#        http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+# an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+# specific language governing permissions and limitations under the License.\n+\n+import ast\n+import re\n+from pathlib import Path\n+from typing import List\n+\n+_end_doc = re.compile(r\"\\\"\\\"\\\"\\s*(#\\s*noqa\\s*:\\s*E501)?\\s*\\n\")\n+\n+\n+def _get_function_delimiters(initial_line, lines):\n+    begin = end = initial_line\n+    while True:\n+        if lines[begin - 1] == \"\\n\":\n+            break\n+        begin -= 1\n+\n+    if lines[end].endswith(\"(\\n\"):\n+        while \":\\n\" not in lines[end]:\n+            end += 1\n+\n+    if '\"\"\"' in lines[end + 1]:\n+        while True:\n+            if _end_doc.search(lines[end]):\n+                break\n+            end += 1\n+    return begin, end + 1\n+\n+\n+def _get_file_lines(filename: str) -> List[str]:\n+    # Get file lines for later\n+    with open(filename) as f:\n+        return f.readlines()\n+\n+\n+def _get_file_ast(filename: str):\n+    # Get raw text and build ast\n+    _config = Path(filename)\n+    _tree = _config.read_text()\n+    return ast.parse(_tree)\n+\n+\n+def _build_base_config_pyi(filename, base_pyi) -> str:\n+    lines = _get_file_lines(filename)\n+    tree = _get_file_ast(filename)\n+\n+    class_lineno = [f.lineno for f in ast.walk(tree) if isinstance(f, ast.ClassDef) and f.name == \"Config\"]\n+    begin_class, end_class = _get_function_delimiters(class_lineno[0] - 1, lines)\n+\n+    base_pyi += \"\".join(lines[begin_class:end_class])\n+    functions = [f.lineno for f in ast.walk(tree) if isinstance(f, ast.FunctionDef) and not f.name.startswith(\"__\")]\n+\n+    for ln in functions:\n+        begin_line, end_line = _get_function_delimiters(ln - 1, lines)\n+        base_pyi += \"\".join(lines[begin_line:end_line])\n+\n+        base_pyi = __add_docstring(base_pyi, lines, end_line)\n+        base_pyi += \"\\n\"\n+\n+    return base_pyi\n+\n+\n+def __add_docstring(base_pyi, lines, end_line):\n+    if '\"\"\"' not in lines[end_line - 1]:\n+        base_pyi += '\\t\\t\"\"\"\"\"\"\\n'.replace(\"\\t\", \"    \")\n+    return base_pyi\n+\n+\n+def _build_entity_config_pyi(base_pyi, filename, entity_map) -> str:\n+    lines = _get_file_lines(filename)\n+    tree = _get_file_ast(filename)\n+    functions = {}\n+\n+    for f in ast.walk(tree):\n+        if isinstance(f, ast.FunctionDef):\n+            if \"_configure\" in f.name and not f.name.startswith(\"__\"):\n+                functions[f.name] = f.lineno\n+            elif \"_set_default\" in f.name and not f.name.startswith(\"__\"):\n+                functions[f.name] = f.lineno\n+            elif \"_add\" in f.name and not f.name.startswith(\"__\"):\n+                functions[f.name] = f.lineno\n+\n+    for k, v in functions.items():\n+        begin_line, end_line = _get_function_delimiters(v - 1, lines)\n+        try:\n+            func = \"\".join(lines[begin_line:end_line])\n+            func = func if not k.startswith(\"_\") else func.replace(k, entity_map.get(k))\n+            func = __add_docstring(func, lines, end_line) + \"\\n\"\n+            base_pyi += func\n+        except Exception:\n+            print(f\"key={k}\")  # noqa: T201\n+            raise\n+\n+    return base_pyi\n+\n+\n+def _generate_entity_and_property_maps(filenames):\n+    entities_map = {}\n+    property_map = {}\n+    for filename in filenames:\n+        etty_tree = _get_file_ast(filename)\n+        functions = [\n+            f for f in ast.walk(etty_tree) if isinstance(f, ast.Call) and getattr(f.func, \"id\", \"\") == \"_inject_section\"\n+        ]\n+        for f in functions:\n+            entity = ast.unparse(f.args[0])\n+            entities_map[entity] = {}\n+            property_map[eval(ast.unparse(f.args[1]))] = entity\n+            # Remove class name from function map\n+            text = ast.unparse(f.args[-1]).replace(f\"{entity}.\", \"\")\n+            matches = re.findall(r\"\\((.*?)\\)\", text)\n+\n+            for m in matches:\n+                v, k = m.replace(\"'\", \"\").split(\",\")\n+                entities_map[entity][k.strip()] = v\n+    return entities_map, property_map\n+\n+\n+def _generate_acessors(base_pyi, property_map) -> str:\n+    for property, cls in property_map.items():\n+        return_template = f\"Dict[str, {cls}]\" if property != \"job_config\" else f\"{cls}\"\n+        template = (\"\\t@_Classproperty\\n\" + f'\\tdef {property}(cls) -> {return_template}:\\n\\t\\t\"\"\"\"\"\"\\n').replace(\n+            \"\\t\", \"    \"\n+        )\n+        base_pyi += template + \"\\n\"\n+    return base_pyi\n+\n+\n+def _build_header(filename) -> str:\n+    _file = Path(filename)\n+    return _file.read_text() + \"\\n\"\n+\n+\n+if __name__ == \"__main__\":\n+    header_file = \"tools/config/pyi_header.py\"\n+    base_config = \"taipy/common/config/config.py\"\n+    config_init = [Path(\"taipy/core/config/__init__.py\"), Path(\"taipy/rest/config/__init__.py\")]\n+\n+    dn_filename = \"taipy/core/config/data_node_config.py\"\n+    job_filename = \"taipy/core/config/job_config.py\"\n+    scenario_filename = \"taipy/core/config/scenario_config.py\"\n+    task_filename = \"taipy/core/config/task_config.py\"\n+    core_filename = \"taipy/core/config/core_section.py\"\n+\n+    rest_filename = \"taipy/rest/config/rest_config.py\"\n+\n+    entities_map, property_map = _generate_entity_and_property_maps(config_init)\n+    pyi = _build_header(header_file)\n+    pyi = _build_base_config_pyi(base_config, pyi)\n+    pyi = _generate_acessors(pyi, property_map)\n+    pyi = _build_entity_config_pyi(pyi, scenario_filename, entities_map[\"ScenarioConfig\"])\n+    pyi = _build_entity_config_pyi(pyi, dn_filename, entities_map[\"DataNodeConfig\"])\n+    pyi = _build_entity_config_pyi(pyi, task_filename, entities_map[\"TaskConfig\"])\n+    pyi = _build_entity_config_pyi(pyi, job_filename, entities_map[\"JobConfig\"])\n+    pyi = _build_entity_config_pyi(pyi, core_filename, entities_map[\"CoreSection\"])\n+\n+    pyi = _build_entity_config_pyi(pyi, rest_filename, entities_map[\"RestConfig\"])\n+\n+    # Remove the final redundant \\n\n+    pyi = pyi[:-1]\n+\n+    with open(\"taipy/common/config/config.pyi\", \"w\") as f:\n+        f.writelines(pyi)\n"
        },
        {
            "commit": "668b6127c95ae34b03f404321b94337c846166d2",
            "file_path": "tools/config/pyi_header.py",
            "diff": "diff --git a/tools/config/pyi_header.py b/tools/config/pyi_header.py\nnew file mode 100644\nindex 00000000..4a0a99ef\n--- /dev/null\n+++ b/tools/config/pyi_header.py\n@@ -0,0 +1,27 @@\n+# Copyright 2021-2025 Avaiga Private Limited\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+# the License. You may obtain a copy of the License at\n+#\n+#        http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+# an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+# specific language governing permissions and limitations under the License.\n+\n+import json\n+from datetime import timedelta\n+from typing import Any, Callable, Dict, List, Optional, Union\n+\n+from taipy.common.config._config import _Config\n+from taipy.core.common.frequency import Frequency\n+from taipy.core.common.scope import Scope\n+from taipy.core.config import CoreSection, DataNodeConfig, JobConfig, ScenarioConfig, TaskConfig\n+from taipy.rest.config import RestConfig\n+\n+from .checker.issue_collector import IssueCollector\n+from .common._classproperty import _Classproperty\n+from .common._config_blocker import _ConfigBlocker\n+from .global_app.global_app_config import GlobalAppConfig\n+from .section import Section\n+from .unique_section import UniqueSection\n"
        }
    ]
}