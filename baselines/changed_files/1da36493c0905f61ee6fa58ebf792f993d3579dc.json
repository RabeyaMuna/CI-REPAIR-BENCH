{
    "sha_fail": "1da36493c0905f61ee6fa58ebf792f993d3579dc",
    "changed_files": [
        {
            "commit": "1da36493c0905f61ee6fa58ebf792f993d3579dc",
            "file_path": "libs/agno/agno/knowledge/csv_url.py",
            "diff": "diff --git a/libs/agno/agno/knowledge/csv_url.py b/libs/agno/agno/knowledge/csv_url.py\nindex 1a182153b..16fd02a80 100644\n--- a/libs/agno/agno/knowledge/csv_url.py\n+++ b/libs/agno/agno/knowledge/csv_url.py\n@@ -8,6 +8,7 @@ from agno.utils.log import log_info, logger\n \n class CSVUrlKnowledgeBase(AgentKnowledge):\n     urls: Optional[Union[List[str], List[Dict[str, Union[str, Dict[str, Any]]]]]] = None\n+    formats: List[str] = [\".csv\"]\n     reader: CSVUrlReader = CSVUrlReader()\n \n     @property\n@@ -73,7 +74,7 @@ class CSVUrlKnowledgeBase(AgentKnowledge):\n         \"\"\"Load documents from a single CSV URL with specific metadata into the vector DB.\"\"\"\n \n         # Validate URL and prepare collection in one step\n-        if not self.prepare_load_url(url, metadata, recreate):\n+        if not self.prepare_load(url, self.formats, metadata, recreate, is_url=True):\n             return\n \n         # Read documents\n@@ -103,7 +104,7 @@ class CSVUrlKnowledgeBase(AgentKnowledge):\n         \"\"\"Load documents from a single CSV URL with specific metadata into the vector DB.\"\"\"\n \n         # Validate URL and prepare collection in one step\n-        if not await self.aprepare_load_url(url, metadata, recreate):\n+        if not await self.aprepare_load(url, self.formats, metadata, recreate, is_url=True):\n             return\n \n         # Read documents\n@@ -121,65 +122,3 @@ class CSVUrlKnowledgeBase(AgentKnowledge):\n             skip_existing=skip_existing,\n             source_info=url,\n         )\n-\n-    def prepare_load_url(\n-        self,\n-        url: str,\n-        metadata: Optional[Dict[str, Any]] = None,\n-        recreate: bool = False,\n-    ) -> bool:\n-        \"\"\"Validate URL and prepare collection for loading.\"\"\"\n-        # 1. Validate URL\n-        if not self._is_valid_csv_url(url):\n-            logger.error(f\"Invalid CSV URL: {url}\")\n-            return False\n-\n-        # 2. Track metadata\n-        if metadata:\n-            self._track_metadata_structure(metadata)\n-\n-        # 3. Prepare vector DB\n-        if self.vector_db is None:\n-            logger.warning(\"Cannot load URL: No vector db provided.\")\n-            return False\n-\n-        # Recreate collection if requested\n-        if recreate:\n-            self.vector_db.drop()\n-\n-        # Create collection if it doesn't exist\n-        if not self.vector_db.exists():\n-            self.vector_db.create()\n-\n-        return True\n-\n-    async def aprepare_load_url(\n-        self,\n-        url: str,\n-        metadata: Optional[Dict[str, Any]] = None,\n-        recreate: bool = False,\n-    ) -> bool:\n-        \"\"\"Validate URL and prepare collection for loading asynchronously.\"\"\"\n-        # 1. Validate URL\n-        if not self._is_valid_csv_url(url):\n-            logger.error(f\"Invalid CSV URL: {url}\")\n-            return False\n-\n-        # 2. Track metadata\n-        if metadata:\n-            self._track_metadata_structure(metadata)\n-\n-        # 3. Prepare vector DB\n-        if self.vector_db is None:\n-            logger.warning(\"Cannot load URL: No vector db provided.\")\n-            return False\n-\n-        # Recreate collection if requested\n-        if recreate:\n-            await self.vector_db.async_drop()\n-\n-        # Create collection if it doesn't exist\n-        if not await self.vector_db.async_exists():\n-            await self.vector_db.async_create()\n-\n-        return True\n"
        }
    ]
}