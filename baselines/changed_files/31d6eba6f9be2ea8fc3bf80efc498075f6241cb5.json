{
    "sha_fail": "31d6eba6f9be2ea8fc3bf80efc498075f6241cb5",
    "changed_files": [
        {
            "commit": "31d6eba6f9be2ea8fc3bf80efc498075f6241cb5",
            "file_path": "cookbook/tools/nebius_tools.py",
            "diff": "diff --git a/cookbook/tools/nebius_tools.py b/cookbook/tools/nebius_tools.py\nnew file mode 100644\nindex 000000000..4494de2b4\n--- /dev/null\n+++ b/cookbook/tools/nebius_tools.py\n@@ -0,0 +1,84 @@\n+\"\"\"Run `pip install openai agno` to install dependencies.\n+\n+This example demonstrates how to use NebiusTools for text-to-image generation with Nebius AI Studio.\n+\"\"\"\n+\n+import os\n+from pathlib import Path\n+from uuid import uuid4\n+\n+from agno.agent import Agent\n+from agno.tools.nebius import NebiusTools\n+from agno.utils.media import save_base64_data\n+\n+# Create an Agent with the Nebius text-to-image tool\n+agent = Agent(\n+    tools=[NebiusTools(\n+        # You can provide your API key here or set the NEBIUS_API_KEY environment variable\n+        api_key=os.getenv(\"NEBIUS_API_KEY\"),\n+        image_model=\"black-forest-labs/flux-schnell\",  # Fastest model\n+        image_size=\"1024x1024\",\n+        image_quality=\"standard\",\n+    )],\n+    name=\"Nebius Image Generator\",\n+    show_tool_calls=True,\n+    markdown=True,\n+)\n+\n+# Example 1: Generate a basic image\n+response = agent.run(\n+    \"Generate an image of a futuristic city with flying cars and tall skyscrapers\",\n+)\n+\n+if response.images:\n+    image_path = Path(\"tmp\") / f\"nebius_futuristic_city_{uuid4()}.png\"\n+    Path(\"tmp\").mkdir(exist_ok=True)\n+    save_base64_data(response.images[0].content, image_path)\n+    print(f\"Image saved to {image_path}\")\n+\n+# Example 2: Generate an image with the higher quality model\n+high_quality_agent = Agent(\n+    tools=[NebiusTools(\n+        api_key=os.getenv(\"NEBIUS_API_KEY\"),\n+        image_model=\"black-forest-labs/flux-dev\",  # Better quality model\n+        image_size=\"1024x1024\",\n+        image_quality=\"hd\",  # Higher quality setting\n+    )],\n+    name=\"Nebius High-Quality Image Generator\",\n+    show_tool_calls=True,\n+    markdown=True,\n+)\n+\n+response = high_quality_agent.run(\n+    \"Create a detailed portrait of a cyberpunk character with neon lights\",\n+)\n+\n+# Save the generated image\n+if response.images:\n+    image_path = Path(\"tmp\") / \"nebius_cyberpunk_character_{uuid4()}.png\"\n+    Path(\"tmp\").mkdir(exist_ok=True)\n+    save_base64_data(response.images[0].content, image_path)\n+    print(f\"High-quality image saved to {image_path}\")\n+\n+# Example 3: Generate an image with the SDXL (Stability Diffusion XL model) model\n+sdxl_agent = Agent(\n+    tools=[NebiusTools(\n+        api_key=os.getenv(\"NEBIUS_API_KEY\"),\n+        image_model=\"stability-ai/sdxl\",  # Stability Diffusion XL model\n+        image_size=\"1024x1024\",\n+    )],\n+    name=\"Nebius SDXL Image Generator\",\n+    show_tool_calls=True,\n+    markdown=True,\n+)\n+\n+response = sdxl_agent.run(\n+    \"Create a fantasy landscape with a castle on a floating island\",\n+)\n+\n+# Save the generated image\n+if response.images:\n+    image_path = Path(\"tmp\") / \"nebius_fantasy_landscape_{uuid4()}.png\"\n+    Path(\"tmp\").mkdir(exist_ok=True)\n+    save_base64_data(response.images[0].content, image_path)\n+    print(f\"SDXL image saved to {image_path}\") \n\\ No newline at end of file\n"
        },
        {
            "commit": "31d6eba6f9be2ea8fc3bf80efc498075f6241cb5",
            "file_path": "libs/agno/agno/models/nebius/__init__.py",
            "diff": "diff --git a/libs/agno/agno/models/nebius/__init__.py b/libs/agno/agno/models/nebius/__init__.py\nnew file mode 100644\nindex 000000000..06a58e62d\n--- /dev/null\n+++ b/libs/agno/agno/models/nebius/__init__.py\n@@ -0,0 +1,3 @@\n+from agno.models.nebius.nebius import Nebius\n+\n+__all__ = [\"Nebius\"] \n\\ No newline at end of file\n"
        },
        {
            "commit": "31d6eba6f9be2ea8fc3bf80efc498075f6241cb5",
            "file_path": "libs/agno/agno/models/nebius/nebius.py",
            "diff": "diff --git a/libs/agno/agno/models/nebius/nebius.py b/libs/agno/agno/models/nebius/nebius.py\nnew file mode 100644\nindex 000000000..fcb8ca76b\n--- /dev/null\n+++ b/libs/agno/agno/models/nebius/nebius.py\n@@ -0,0 +1,62 @@\n+from dataclasses import dataclass\n+from os import getenv\n+from typing import Any, Dict, Optional\n+\n+from agno.exceptions import ModelProviderError\n+from agno.models.openai.like import OpenAILike\n+\n+\n+@dataclass\n+class Nebius(OpenAILike):\n+    \"\"\"\n+    A class for interacting with Nebius AI Studio models.\n+\n+    Attributes:\n+        id (str): The model id. Defaults to \"black-forest-labs/flux-schnell\".\n+        name (str): The model name. Defaults to \"Nebius\".\n+        provider (str): The provider name. Defaults to \"Nebius\".\n+        api_key (Optional[str]): The API key.\n+        base_url (str): The base URL. Defaults to \"https://api.studio.nebius.com/v1\".\n+    \"\"\"\n+\n+    id: str = \"black-forest-labs/flux-schnell\"  # Default model for image generation\n+    name: str = \"Nebius\"\n+    provider: str = \"Nebius\"\n+\n+    api_key: Optional[str] = getenv(\"NEBIUS_API_KEY\")\n+    base_url: str = \"https://api.studio.nebius.com/v1\"\n+\n+    # Feature flags based on current knowledge of Nebius capabilities\n+    supports_native_structured_outputs: bool = False  # Set this to True if Nebius supports structured outputs\n+    supports_json_schema_outputs: bool = True  # Set this to True if Nebius supports JSON schema outputs\n+\n+    def _get_client_params(self) -> Dict[str, Any]:\n+        # Fetch API key from env if not already set\n+        if not self.api_key:\n+            self.api_key = getenv(\"NEBIUS_API_KEY\")\n+            if not self.api_key:\n+                # Raise error immediately if key is missing\n+                raise ModelProviderError(\n+                    message=\"NEBIUS_API_KEY not set. Please set the NEBIUS_API_KEY environment variable.\",\n+                    model_name=self.name,\n+                    model_id=self.id,\n+                )\n+\n+        # Define base client params\n+        base_params = {\n+            \"api_key\": self.api_key,\n+            \"organization\": self.organization,\n+            \"base_url\": self.base_url,\n+            \"timeout\": self.timeout,\n+            \"max_retries\": self.max_retries,\n+            \"default_headers\": self.default_headers,\n+            \"default_query\": self.default_query,\n+        }\n+\n+        # Create client_params dict with non-None values\n+        client_params = {k: v for k, v in base_params.items() if v is not None}\n+\n+        # Add additional client params if provided\n+        if self.client_params:\n+            client_params.update(self.client_params)\n+        return client_params \n\\ No newline at end of file\n"
        },
        {
            "commit": "31d6eba6f9be2ea8fc3bf80efc498075f6241cb5",
            "file_path": "libs/agno/agno/tools/nebius.py",
            "diff": "diff --git a/libs/agno/agno/tools/nebius.py b/libs/agno/agno/tools/nebius.py\nnew file mode 100644\nindex 000000000..13a9fde44\n--- /dev/null\n+++ b/libs/agno/agno/tools/nebius.py\n@@ -0,0 +1,111 @@\n+from os import getenv\n+from typing import Optional\n+from uuid import uuid4\n+\n+from agno.agent import Agent\n+from agno.media import ImageArtifact\n+from agno.models.nebius import Nebius\n+from agno.tools import Toolkit\n+from agno.utils.log import log_debug, log_error, log_warning\n+\n+\n+class NebiusTools(Toolkit):\n+    \"\"\"Tools for interacting with Nebius AI Studio's text-to-image API\"\"\"\n+\n+    def __init__(\n+        self,\n+        api_key: Optional[str] = None,\n+        base_url: str = \"https://api.studio.nebius.com/v1\",\n+        image_model: str = \"black-forest-labs/flux-schnell\",\n+        image_quality: Optional[str] = \"standard\",\n+        image_size: Optional[str] = \"1024x1024\",\n+        image_style: Optional[str] = None,\n+        **kwargs,\n+    ):\n+        \"\"\"Initialize Nebius AI Studio text-to-image tools.\n+\n+        Args:\n+            api_key: Nebius API key. If not provided, will look for NEBIUS_API_KEY environment variable.\n+            base_url: The base URL for the Nebius AI Studio API. This should be configured according to Nebius's documentation.\n+            image_model: The model to use for generation. Options include:\n+                  - \"black-forest-labs/flux-schnell\" (fastest)\n+                  - \"black-forest-labs/flux-dev\" (balanced)\n+                  - \"stability-ai/sdxl\" (highest quality)\n+            image_quality: Image quality. Options: \"standard\", \"hd\".\n+            image_size: Image size in format \"WIDTHxHEIGHT\". Max supported: 2000x2000.\n+            image_style: Optional style preset to apply.\n+            **kwargs: Additional arguments to pass to Toolkit.\n+        \"\"\"\n+        super().__init__(name=\"nebius_tools\", **kwargs)\n+\n+        self.api_key = api_key or getenv(\"NEBIUS_API_KEY\")\n+        if not self.api_key:\n+            raise ValueError(\"NEBIUS_API_KEY not set. Please set the NEBIUS_API_KEY environment variable.\")\n+\n+        self.base_url = base_url\n+        self.image_model = image_model\n+        self.image_quality = image_quality\n+        self.image_size = image_size\n+        self.image_style = image_style\n+        \n+        self.nebius = Nebius(\n+            api_key=self.api_key,\n+            base_url=self.base_url,\n+            id=self.image_model\n+        )\n+\n+        self.register(self.generate_image)\n+\n+    def generate_image(\n+        self,\n+        agent: Agent,\n+        prompt: str,\n+    ) -> str:\n+        \"\"\"Generate images based on a text prompt using Nebius AI Studio.\n+\n+        Args:\n+            agent: The agent instance for adding images\n+            prompt: The text prompt to generate images from.\n+\n+        Returns:\n+            A message indicating success or failure.\n+        \"\"\"\n+        try:\n+            extra_params = {\n+                \"size\": self.image_size,\n+                \"quality\": self.image_quality,\n+                \"style\": self.image_style,\n+            }\n+            extra_params = {k: v for k, v in extra_params.items() if v is not None}\n+\n+            client = self.nebius.get_client()\n+\n+            response = client.images.generate(\n+                model=self.image_model,\n+                prompt=prompt,\n+                response_format=\"b64_json\",\n+                **extra_params,\n+            )\n+\n+            data = None\n+            if hasattr(response, \"data\") and response.data:\n+                data = response.data[0]\n+            if data is None:\n+                log_warning(\"Nebius API did not return any data.\")\n+                return \"Failed to generate image: No data received from API.\"\n+            if hasattr(data, \"b64_json\") and data.b64_json:\n+                image_base64 = data.b64_json\n+                media_id = str(uuid4())\n+                agent.add_image(\n+                    ImageArtifact(\n+                        id=media_id,\n+                        content=image_base64,\n+                        mime_type=\"image/png\",\n+                        original_prompt=prompt\n+                    )\n+                )\n+                return \"Image generated successfully.\"\n+            return \"Failed to generate image: No content received from API.\"\n+        except Exception as e:\n+            log_error(f\"Failed to generate image using {self.image_model}: {e}\")\n+            return f\"Failed to generate image: {e}\" \n\\ No newline at end of file\n"
        }
    ]
}