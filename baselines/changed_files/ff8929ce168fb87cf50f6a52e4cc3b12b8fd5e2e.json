{
    "sha_fail": "ff8929ce168fb87cf50f6a52e4cc3b12b8fd5e2e",
    "changed_files": [
        {
            "commit": "ff8929ce168fb87cf50f6a52e4cc3b12b8fd5e2e",
            "file_path": "libs/agno/agno/tools/apify.py",
            "diff": "diff --git a/libs/agno/agno/tools/apify.py b/libs/agno/agno/tools/apify.py\nindex 4394bd6c7..df6f7d323 100644\n--- a/libs/agno/agno/tools/apify.py\n+++ b/libs/agno/agno/tools/apify.py\n@@ -156,7 +156,7 @@ Returns:\n             actor_function.__doc__ = docstring\n \n             # Register the function with the toolkit\n-            self.register(actor_function, sanitize_arguments=False)\n+            self.register(actor_function)\n             # Fix params schema\n             self.functions[tool_name].parameters = props_to_json_schema(properties, required)\n             log_info(f\"Registered Apify Actor '{actor_id}' as function '{tool_name}'\")\n"
        },
        {
            "commit": "ff8929ce168fb87cf50f6a52e4cc3b12b8fd5e2e",
            "file_path": "libs/agno/agno/tools/decorator.py",
            "diff": "diff --git a/libs/agno/agno/tools/decorator.py b/libs/agno/agno/tools/decorator.py\nindex 675780763..36e2370fa 100644\n--- a/libs/agno/agno/tools/decorator.py\n+++ b/libs/agno/agno/tools/decorator.py\n@@ -48,7 +48,7 @@ def tool(*args, **kwargs) -> Union[Function, Callable[[F], Function]]:\n         name: Optional[str] - Override for the function name\n         description: Optional[str] - Override for the function description\n         strict: Optional[bool] - Flag for strict parameter checking\n-        sanitize_arguments: Optional[bool] - If True, arguments are sanitized before passing to function\n+        sanitize_arguments: Optional[bool] - If True, arguments are sanitized before passing to function (Deprecated)\n         instructions: Optional[str] - Instructions for using the tool\n         add_instructions: bool - If True, add instructions to the system message\n         show_result: Optional[bool] - If True, shows the result after function call\n"
        },
        {
            "commit": "ff8929ce168fb87cf50f6a52e4cc3b12b8fd5e2e",
            "file_path": "libs/agno/agno/tools/function.py",
            "diff": "diff --git a/libs/agno/agno/tools/function.py b/libs/agno/agno/tools/function.py\nindex 8c67665ca..cc84a4b52 100644\n--- a/libs/agno/agno/tools/function.py\n+++ b/libs/agno/agno/tools/function.py\n@@ -83,8 +83,8 @@ class Function(BaseModel):\n     entrypoint: Optional[Callable] = None\n     # If True, the entrypoint processing is skipped and the Function is used as is.\n     skip_entrypoint_processing: bool = False\n-    # If True, the arguments are sanitized before being passed to the function.\n-    sanitize_arguments: bool = True\n+    # If True, the arguments are sanitized before being passed to the function. (Deprecated)\n+    sanitize_arguments: bool = False\n     # If True, the function call will show the result along with sending it to the model.\n     show_result: bool = False\n     # If True, the agent will stop after the function call.\n"
        },
        {
            "commit": "ff8929ce168fb87cf50f6a52e4cc3b12b8fd5e2e",
            "file_path": "libs/agno/agno/tools/toolkit.py",
            "diff": "diff --git a/libs/agno/agno/tools/toolkit.py b/libs/agno/agno/tools/toolkit.py\nindex fced49103..5dfe83986 100644\n--- a/libs/agno/agno/tools/toolkit.py\n+++ b/libs/agno/agno/tools/toolkit.py\n@@ -105,12 +105,11 @@ class Toolkit:\n         for tool in self.tools:\n             self.register(tool)\n \n-    def register(self, function: Callable[..., Any], sanitize_arguments: bool = True, name: Optional[str] = None):\n+    def register(self, function: Callable[..., Any], name: Optional[str] = None):\n         \"\"\"Register a function with the toolkit.\n \n         Args:\n             function: The callable to register\n-            sanitize_arguments: Whether to sanitize arguments before passing to the function\n             name: Optional custom name for the function\n \n         Returns:\n@@ -126,7 +125,6 @@ class Toolkit:\n             f = Function(\n                 name=tool_name,\n                 entrypoint=function,\n-                sanitize_arguments=sanitize_arguments,\n                 cache_results=self.cache_results,\n                 cache_dir=self.cache_dir,\n                 cache_ttl=self.cache_ttl,\n"
        },
        {
            "commit": "ff8929ce168fb87cf50f6a52e4cc3b12b8fd5e2e",
            "file_path": "libs/agno/agno/utils/functions.py",
            "diff": "diff --git a/libs/agno/agno/utils/functions.py b/libs/agno/agno/utils/functions.py\nindex 8493a5caf..0abf4a3d5 100644\n--- a/libs/agno/agno/utils/functions.py\n+++ b/libs/agno/agno/utils/functions.py\n@@ -28,14 +28,11 @@ def get_function_call(\n         function_call.call_id = call_id\n     if arguments is not None and arguments != \"\":\n         try:\n-            if function_to_call.sanitize_arguments:\n-                if \"None\" in arguments:\n-                    arguments = arguments.replace(\"None\", \"null\")\n-                if \"True\" in arguments:\n-                    arguments = arguments.replace(\"True\", \"true\")\n-                if \"False\" in arguments:\n-                    arguments = arguments.replace(\"False\", \"false\")\n-            _arguments = json.loads(arguments)\n+            try:\n+                _arguments = json.loads(arguments)\n+            except Exception as e:\n+                import ast\n+                _arguments = ast.literal_eval(arguments)\n         except Exception as e:\n             log_error(f\"Unable to decode function arguments:\\n{arguments}\\nError: {e}\")\n             function_call.error = (\n"
        },
        {
            "commit": "ff8929ce168fb87cf50f6a52e4cc3b12b8fd5e2e",
            "file_path": "libs/agno/tests/unit/tools/test_functions.py",
            "diff": "diff --git a/libs/agno/tests/unit/tools/test_functions.py b/libs/agno/tests/unit/tools/test_functions.py\nindex 934bbae2e..17fa24414 100644\n--- a/libs/agno/tests/unit/tools/test_functions.py\n+++ b/libs/agno/tests/unit/tools/test_functions.py\n@@ -533,7 +533,6 @@ def test_tool_decorator_with_config():\n         strict=True,\n         instructions=\"Custom instructions\",\n         add_instructions=False,\n-        sanitize_arguments=False,\n         show_result=True,\n         stop_after_tool_call=True,\n         requires_confirmation=True,\n@@ -551,7 +550,6 @@ def test_tool_decorator_with_config():\n     assert configured_func.strict is True\n     assert configured_func.instructions == \"Custom instructions\"\n     assert configured_func.add_instructions is False\n-    assert configured_func.sanitize_arguments is False\n     assert configured_func.show_result is True\n     assert configured_func.stop_after_tool_call is True\n     assert configured_func.requires_confirmation is True\n"
        },
        {
            "commit": "ff8929ce168fb87cf50f6a52e4cc3b12b8fd5e2e",
            "file_path": "libs/agno/tests/unit/utils/test_functions.py",
            "diff": "diff --git a/libs/agno/tests/unit/utils/test_functions.py b/libs/agno/tests/unit/utils/test_functions.py\nnew file mode 100644\nindex 000000000..0989a1cb0\n--- /dev/null\n+++ b/libs/agno/tests/unit/utils/test_functions.py\n@@ -0,0 +1,177 @@\n+import json\n+import pytest\n+from typing import Dict, Optional\n+\n+from agno.tools.function import Function, FunctionCall\n+from agno.utils.functions import get_function_call\n+\n+\n+@pytest.fixture\n+def sample_functions() -> Dict[str, Function]:\n+    return {\n+        \"test_function\": Function(\n+            name=\"test_function\",\n+            description=\"A test function\",\n+            parameters={\n+                \"type\": \"object\",\n+                \"properties\": {\n+                    \"param1\": {\"type\": \"string\"},\n+                    \"param2\": {\"type\": \"integer\"},\n+                    \"param3\": {\"type\": \"boolean\"},\n+                },\n+            },\n+        )\n+    }\n+\n+\n+def test_get_function_call_basic(sample_functions):\n+    \"\"\"Test basic function call creation with valid arguments.\"\"\"\n+    arguments = json.dumps({\"param1\": \"test\", \"param2\": 42, \"param3\": True})\n+    call_id = \"test-call-123\"\n+\n+    result = get_function_call(\n+        name=\"test_function\",\n+        arguments=arguments,\n+        call_id=call_id,\n+        functions=sample_functions,\n+    )\n+\n+    assert result is not None\n+    assert isinstance(result, FunctionCall)\n+    assert result.function == sample_functions[\"test_function\"]\n+    assert result.call_id == call_id\n+    assert result.arguments == {\"param1\": \"test\", \"param2\": 42, \"param3\": True}\n+    assert result.error is None\n+\n+\n+def test_get_function_call_invalid_name(sample_functions):\n+    \"\"\"Test function call with non-existent function name.\"\"\"\n+    result = get_function_call(\n+        name=\"non_existent_function\",\n+        arguments='{\"param1\": \"test\"}',\n+        functions=sample_functions,\n+    )\n+\n+    assert result is None\n+\n+\n+def test_get_function_call_no_functions():\n+    \"\"\"Test function call with no functions dictionary.\"\"\"\n+    result = get_function_call(\n+        name=\"test_function\",\n+        arguments='{\"param1\": \"test\"}',\n+        functions=None,\n+    )\n+\n+    assert result is None\n+\n+\n+def test_get_function_call_invalid_json(sample_functions):\n+    \"\"\"Test function call with invalid JSON arguments.\"\"\"\n+    result = get_function_call(\n+        name=\"test_function\",\n+        arguments=\"invalid json\",\n+        functions=sample_functions,\n+    )\n+\n+    assert result is not None\n+    assert result.error is not None\n+    assert \"Error while decoding function arguments\" in result.error\n+\n+\n+def test_get_function_call_non_dict_arguments(sample_functions):\n+    \"\"\"Test function call with non-dictionary arguments.\"\"\"\n+    result = get_function_call(\n+        name=\"test_function\",\n+        arguments='[\"not\", \"a\", \"dict\"]',\n+        functions=sample_functions,\n+    )\n+\n+    assert result is not None\n+    assert result.error is not None\n+    assert \"Function arguments are not a valid JSON object\" in result.error\n+\n+\n+def test_get_function_call_argument(sample_functions):\n+    \"\"\"Test argument sanitization for boolean and null values.\"\"\"\n+    arguments = json.dumps({\n+        \"param1\": \"None\",\n+        \"param2\": \"True\",\n+        \"param3\": \"False\",\n+        \"param4\": \"  test  \",\n+    })\n+\n+    result = get_function_call(\n+        name=\"test_function\",\n+        arguments=arguments,\n+        functions=sample_functions,\n+    )\n+\n+    assert result is not None\n+    assert result.arguments == {\n+        \"param1\": None,\n+        \"param2\": True,\n+        \"param3\": False,\n+        \"param4\": \"test\",\n+    }\n+\n+\n+def test_get_function_call_argument_2(sample_functions):\n+    \"\"\"Test function call without argument sanitization.\"\"\"\n+    arguments = '{\"param1\": None, \"param2\": True, \"param3\": False, \"param4\": \"test\"}'\n+\n+    result = get_function_call(\n+        name=\"test_function\",\n+        arguments=arguments,\n+        functions=sample_functions,\n+    )\n+\n+    assert result is not None\n+    assert result.arguments == {\n+        \"param1\": None,\n+        \"param2\": True,\n+        \"param3\": False,\n+        \"param4\": \"test\",\n+    }\n+\n+    arguments = '{\"param1\": \"none\", \"param2\": \"false\", \"param3\": \"true\", \"param4\": \"test\"}'\n+\n+    result = get_function_call(\n+        name=\"test_function\",\n+        arguments=arguments,\n+        functions=sample_functions,\n+    )\n+\n+    assert result is not None\n+    assert result.arguments == {\n+        \"param1\": None,\n+        \"param2\": False,\n+        \"param3\": True,\n+        \"param4\": \"test\",\n+    }\n+\n+\n+def test_get_function_call_empty_arguments(sample_functions):\n+    \"\"\"Test function call with empty arguments.\"\"\"\n+    result = get_function_call(\n+        name=\"test_function\",\n+        arguments=\"\",\n+        functions=sample_functions,\n+    )\n+\n+    assert result is not None\n+    assert result.arguments is None\n+    assert result.error is None\n+\n+\n+def test_get_function_call_no_arguments(sample_functions):\n+    \"\"\"Test function call with no arguments provided.\"\"\"\n+    result = get_function_call(\n+        name=\"test_function\",\n+        arguments=None,\n+        functions=sample_functions,\n+    )\n+\n+    assert result is not None\n+    assert result.arguments is None\n+    assert result.error is None\n"
        }
    ]
}