{
    "sha_fail": "754f4d3afe097bd3d360bb8a186acd95cc2542ea",
    "changed_files": [
        {
            "commit": "754f4d3afe097bd3d360bb8a186acd95cc2542ea",
            "file_path": "cookbook/tools/daytona_tools.py",
            "diff": "diff --git a/cookbook/tools/daytona_tools.py b/cookbook/tools/daytona_tools.py\nindex fb47d6c1d..c50f319a5 100644\n--- a/cookbook/tools/daytona_tools.py\n+++ b/cookbook/tools/daytona_tools.py\n@@ -19,27 +19,24 @@ agent = Agent(\n     tools=[DaytonaTools()],\n     markdown=True,\n     instructions=[\n-        \"You are an expert at writing and validating Python code. You have access to a remote, secure Daytona sandbox.\",\n+        \"You are an expert at writing and executing code. You have access to a remote, secure Daytona sandbox.\",\n         \"Your primary purpose is to:\",\n-        \"1. Write clear, efficient Python code based on user requests\",\n-        \"2. Execute and verify the code in the Daytona sandbox\",\n-        \"3. Share the complete code with the user, as this is the main use case\",\n-        \"4. Provide thorough explanations of how the code works\",\n-        \"You can use the run_python_code tool to run Python code in the Daytona sandbox.\",\n+        \"1. Write clear, efficient code based on user requests\",\n+        \"2. ALWAYS execute the code in the Daytona sandbox using run_code\",\n+        \"3. Show the actual execution results to the user\",\n+        \"4. Provide explanations of how the code works and what the output means\",\n         \"Guidelines:\",\n-        \"- ALWAYS share the complete code with the user, properly formatted in code blocks\",\n-        \"- Verify code functionality by executing it in the sandbox before sharing\",\n-        \"- Iterate and debug code as needed to ensure it works correctly\",\n-        \"- Use pandas, matplotlib, and other Python libraries for data analysis when appropriate\",\n-        \"- Create proper visualizations when requested and add them as image artifacts to show inline\",\n-        \"- Handle file uploads and downloads properly\",\n-        \"- Explain your approach and the code's functionality in detail\",\n-        \"- Format responses with both code and explanations for maximum clarity\",\n+        \"- NEVER just provide code without executing it\",\n+        \"- Execute all code using the run_code tool to show real results\",\n+        \"- Support Python, JavaScript, and TypeScript execution\",\n+        \"- Use file operations (create_file, read_file) when working with scripts\",\n+        \"- Install missing packages when needed using run_shell_command\",\n+        \"- Always show both the code AND the execution output\",\n         \"- Handle errors gracefully and explain any issues encountered\",\n     ],\n     show_tool_calls=True,\n )\n \n agent.print_response(\n-    \"Write Python code to generate the first 10 Fibonacci numbers and calculate their sum and average\"\n+    \"Write JavaScript code to generate 10 random numbers between 1 and 100, sort them in ascending order, and print each number\"\n )\n"
        },
        {
            "commit": "754f4d3afe097bd3d360bb8a186acd95cc2542ea",
            "file_path": "daytona_sdk_python_code",
            "diff": "diff --git a/daytona_sdk_python_code b/daytona_sdk_python_code\ndeleted file mode 160000\nindex d1d5fa4fc..000000000\n--- a/daytona_sdk_python_code\n+++ /dev/null\n@@ -1 +0,0 @@\n-Subproject commit d1d5fa4fc71d290c15a050ffbbb2f7379885ed60\n"
        },
        {
            "commit": "754f4d3afe097bd3d360bb8a186acd95cc2542ea",
            "file_path": "libs/agno/agno/tools/daytona.py",
            "diff": "diff --git a/libs/agno/agno/tools/daytona.py b/libs/agno/agno/tools/daytona.py\nindex 781bc3033..d2114c4d2 100644\n--- a/libs/agno/agno/tools/daytona.py\n+++ b/libs/agno/agno/tools/daytona.py\n@@ -8,7 +8,7 @@ from agno.agent import Agent\n from agno.team import Team\n from agno.tools import Toolkit\n from agno.utils.code_execution import prepare_python_code\n-from agno.utils.log import log_error, log_info, log_warning, log_debug\n+from agno.utils.log import log_debug, log_error, log_info, log_warning\n \n try:\n     from daytona import (\n@@ -21,11 +21,10 @@ try:\n except ImportError:\n     raise ImportError(\"`daytona` not installed. Please install using `pip install daytona`\")\n \n-\n DEFAULT_INSTRUCTIONS = dedent(\n     \"\"\"\\\n     You have access to a persistent Daytona sandbox for code execution. The sandbox maintains state across interactions.\n-\n+    \n     Available tools:\n     - `run_code`: Execute code in the sandbox\n     - `run_shell_command`: Execute shell commands (bash)\n@@ -34,14 +33,22 @@ DEFAULT_INSTRUCTIONS = dedent(\n     - `list_files`: List directory contents\n     - `delete_file`: Delete files or directories\n     - `change_directory`: Change the working directory\n-\n+    \n+    MANDATORY: When users ask for code (Python, JavaScript, TypeScript, etc.), you MUST:\n+    1. Write the code\n+    2. Execute it using run_code tool\n+    3. Show the actual output/results\n+    4. Never just provide code without executing it\n+    \n     CRITICAL WORKFLOW:\n     1. Before running Python scripts, check if required packages are installed\n     2. Install missing packages with: run_shell_command(\"pip install package1 package2\")\n     3. When running scripts, capture both output AND errors\n     4. If a script produces no output, check for errors or add print statements\n-\n+    \n     IMPORTANT: Always use single quotes for the content parameter when creating files\n+    \n+    Remember: Your job is to provide working, executed code examples, not just code snippets!\n     \"\"\"\n )\n \n@@ -66,7 +73,7 @@ class DaytonaTools(Toolkit):\n         verify_ssl: Optional[bool] = False,\n         persistent: bool = True,\n         instructions: Optional[str] = None,\n-        add_instructions: bool = True,\n+        add_instructions: bool = False,\n         **kwargs,\n     ):\n         self.api_key = api_key or getenv(\"DAYTONA_API_KEY\")\n@@ -74,10 +81,12 @@ class DaytonaTools(Toolkit):\n             raise ValueError(\"DAYTONA_API_KEY not set. Please set the DAYTONA_API_KEY environment variable.\")\n \n         self.api_url = api_url or getenv(\"DAYTONA_API_URL\")\n+        self.sandbox_id = sandbox_id\n         self.sandbox_target = sandbox_target\n         self.organization_id = organization_id\n         self.sandbox_language = sandbox_language or CodeLanguage.PYTHON\n         self.sandbox_os = sandbox_os\n+        self.auto_stop_interval = auto_stop_interval\n         self.sandbox_os_user = sandbox_os_user\n         self.sandbox_env_vars = sandbox_env_vars\n         self.sandbox_labels = sandbox_labels or {}\n@@ -85,9 +94,11 @@ class DaytonaTools(Toolkit):\n         self.timeout = timeout\n         self.auto_create_sandbox = auto_create_sandbox\n         self.persistent = persistent\n-        self.instructions = instructions or DEFAULT_INSTRUCTIONS\n         self.verify_ssl = verify_ssl\n \n+        # Set instructions - use default if none provided\n+        self.instructions = instructions or DEFAULT_INSTRUCTIONS\n+\n         if not self.verify_ssl:\n             self._disable_ssl_verification()\n \n@@ -120,7 +131,6 @@ class DaytonaTools(Toolkit):\n         try:\n             from daytona_api_client import Configuration\n \n-            # Store the original __init__ method\n             original_init = Configuration.__init__\n \n             # Create a wrapper that sets verify_ssl = False\n@@ -128,7 +138,6 @@ class DaytonaTools(Toolkit):\n                 original_init(self, *args, **kwargs)\n                 self.verify_ssl = False\n \n-            # Apply the monkey patch\n             setattr(Configuration, \"__init__\", patched_init)\n             import urllib3\n \n@@ -156,12 +165,21 @@ class DaytonaTools(Toolkit):\n             log_info(f\"Updated working directory to: {directory}\")\n \n     def _get_or_create_sandbox(self, agent: Union[Agent, Team]) -> Sandbox:\n-        \"\"\"Get existing sandbox or create new one if not found.\"\"\"\n+        \"\"\"Get existing sandbox or create new one\"\"\"\n         try:\n             sandbox = None\n-            sandbox_id = None\n \n-            if self.persistent and agent and hasattr(agent, \"session_state\"):\n+            # Use explicit sandbox\n+            if self.sandbox_id:\n+                try:\n+                    sandbox = self.daytona.get(self.sandbox_id)\n+                    log_debug(f\"Using explicit sandbox: {self.sandbox_id}\")\n+                except Exception as e:\n+                    log_debug(f\"Failed to get sandbox {self.sandbox_id}: {e}\")\n+                    sandbox = None\n+\n+            # Use persistent sandbox\n+            elif self.persistent and hasattr(agent, \"session_state\"):\n                 if agent.session_state is None:\n                     agent.session_state = {}\n \n@@ -169,15 +187,19 @@ class DaytonaTools(Toolkit):\n                 if sandbox_id:\n                     try:\n                         sandbox = self.daytona.get(sandbox_id)\n+                        log_debug(f\"Using persistent sandbox: {sandbox_id}\")\n                     except Exception as e:\n-                        log_warning(f\"Failed to get sandbox {sandbox_id}: {e}. Creating new one.\")\n+                        log_debug(f\"Failed to get sandbox {sandbox_id}: {e}\")\n                         sandbox = None\n \n-                if not sandbox:\n-                    sandbox = self._create_new_sandbox(agent)\n-                    agent.session_state[\"sandbox_id\"] = sandbox.id\n-            else:\n+            # Create new sandbox if none found\n+            if sandbox is None:\n                 sandbox = self._create_new_sandbox(agent)\n+                # Store sandbox ID for persistent sandboxes\n+                if self.persistent and hasattr(agent, \"session_state\"):\n+                    if agent.session_state is None:\n+                        agent.session_state = {}\n+                    agent.session_state[\"sandbox_id\"] = sandbox.id\n \n             # Ensure sandbox is started\n             if sandbox.state != \"started\":\n@@ -206,7 +228,7 @@ class DaytonaTools(Toolkit):\n                 language=self.sandbox_language,\n                 os_user=self.sandbox_os_user,\n                 env_vars=self.sandbox_env_vars,\n-                auto_stop_interval=60,  # Stop after 1 hour\n+                auto_stop_interval=self.auto_stop_interval,\n                 labels=labels,\n                 public=self.sandbox_public,\n             )\n"
        }
    ]
}