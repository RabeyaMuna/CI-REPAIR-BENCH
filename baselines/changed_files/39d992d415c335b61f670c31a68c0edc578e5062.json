{
    "sha_fail": "39d992d415c335b61f670c31a68c0edc578e5062",
    "changed_files": [
        {
            "commit": "39d992d415c335b61f670c31a68c0edc578e5062",
            "file_path": "libs/agno/agno/agent/agent.py",
            "diff": "diff --git a/libs/agno/agno/agent/agent.py b/libs/agno/agno/agent/agent.py\nindex 208010bbe..8617f69e9 100644\n--- a/libs/agno/agno/agent/agent.py\n+++ b/libs/agno/agno/agent/agent.py\n@@ -666,7 +666,6 @@ class Agent:\n                     if message.role == \"assistant\":\n                         parser_model_response_message = message\n                         break\n-\n                 if parser_model_response_message is not None:\n                     run_messages.messages.append(parser_model_response_message)\n                     model_response.parsed = parser_model_response.parsed\n@@ -1120,10 +1119,11 @@ class Agent:\n         # If a parser model is provided, structure the response separately\n         if self.parser_model is not None:\n             if self.response_model is not None:\n-                messages_for_parser_model = self.get_messages_for_parser_model(model_response)\n+                parser_response_format = self._get_response_format(self.parser_model)\n+                messages_for_parser_model = self.get_messages_for_parser_model(model_response, parser_response_format)\n                 parser_model_response: ModelResponse = await self.parser_model.aresponse(\n                     messages=messages_for_parser_model,\n-                    response_format=self.response_model,\n+                    response_format=parser_response_format,\n                 )\n                 parser_model_response_message: Optional[Message] = None\n                 for message in reversed(messages_for_parser_model):\n@@ -4806,7 +4806,7 @@ class Agent:\n             else \"You are tasked with creating a structured output from the provided data.\"\n         )\n \n-        if response_format == {\"type\": \"json_object\"}:\n+        if response_format == {\"type\": \"json_object\"} and self.response_model is not None:  # type: ignore\n             system_content += f\"{get_json_output_prompt(self.response_model)}\"\n \n         return [\n"
        }
    ]
}