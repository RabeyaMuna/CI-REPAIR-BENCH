{
    "sha_fail": "c4330a42492e01350945e09419953aa3f40fb796",
    "changed_files": [
        {
            "commit": "c4330a42492e01350945e09419953aa3f40fb796",
            "file_path": "tests/middleware/test_logging.py",
            "diff": "diff --git a/tests/middleware/test_logging.py b/tests/middleware/test_logging.py\nindex 6064bcc..051adec 100644\n--- a/tests/middleware/test_logging.py\n+++ b/tests/middleware/test_logging.py\n@@ -212,3 +212,46 @@ async def test_server_start_with_port_zero(caplog: pytest.LogCaptureFixture):\n         host, port = sock.getsockname()\n     messages = [record.message for record in caplog.records if \"uvicorn\" in record.name]\n     assert f\"Uvicorn running on http://{host}:{port} (Press CTRL+C to quit)\" in messages\n+\n+\n+async def test_gunicorn_access_log_format(unused_tcp_port: int, capsys: pytest.CaptureFixture[str]) -> None:\n+    \"\"\"Test access logging with Gunicorn format.\"\"\"\n+    config = Config(\n+        app=app,\n+        access_log_format='%(h)s \"%(r)s\" %(s)s %(b)s',\n+        http=\"h11\",\n+        port=unused_tcp_port,\n+    )\n+    async with run_server(config):\n+        async with httpx.AsyncClient() as client:\n+            response = await client.get(f\"http://127.0.0.1:{unused_tcp_port}\")\n+\n+    assert response.status_code == 204\n+    captured = capsys.readouterr()\n+    # Check Gunicorn format is used in stdout\n+    assert \"127.0.0.1\" in captured.out\n+    assert '\"GET / HTTP/1.1\"' in captured.out\n+    assert \" 204 \" in captured.out\n+    assert \" -\" in captured.out  # This is the %(b)s part (response size is None -> \"-\")\n+\n+\n+@pytest.mark.anyio\n+async def test_gunicorn_access_log_format_httptools(unused_tcp_port: int, capsys: pytest.CaptureFixture[str]) -> None:\n+    \"\"\"Test access logging with Gunicorn format using httptools.\"\"\"\n+    config = Config(\n+        app=app,\n+        access_log_format='%(h)s \"%(r)s\" %(s)s %(b)s',\n+        http=\"httptools\",\n+        port=unused_tcp_port,\n+    )\n+    async with run_server(config):\n+        async with httpx.AsyncClient() as client:\n+            response = await client.get(f\"http://127.0.0.1:{unused_tcp_port}\")\n+\n+    assert response.status_code == 204\n+    captured = capsys.readouterr()\n+    # Check Gunicorn format is used in stdout\n+    assert \"127.0.0.1\" in captured.out\n+    assert '\"GET / HTTP/1.1\"' in captured.out\n+    assert \" 204 \" in captured.out\n+    assert \" -\" in captured.out  # This is the %(b)s part (response size is None -> \"-\")\n"
        },
        {
            "commit": "c4330a42492e01350945e09419953aa3f40fb796",
            "file_path": "tests/test_logging.py",
            "diff": "diff --git a/tests/test_logging.py b/tests/test_logging.py\nindex 05a8a6c..bd8c3fe 100644\n--- a/tests/test_logging.py\n+++ b/tests/test_logging.py\n@@ -516,3 +516,54 @@ def test_formatter_with_logger() -> None:\n     assert '\"GET /api/users?page=1 HTTP/1.1\"' in output\n     assert \" 200 \" in output\n     assert \" 2048\" in output\n+\n+\n+def test_formatter_with_colors() -> None:\n+    \"\"\"Test formatter with colors enabled.\"\"\"\n+    formatter = GunicornAccessFormatter(fmt=\"%(r)s %(s)s\", use_colors=True)\n+    scope = create_scope(method=\"POST\", path=\"/test\")\n+\n+    record = logging.LogRecord(\n+        name=\"test\",\n+        level=logging.INFO,\n+        pathname=\"test.py\",\n+        lineno=1,\n+        msg=\"\",\n+        args=(scope, 200, 0.123, 1024),\n+        exc_info=None,\n+    )\n+\n+    output = formatter.format(record)\n+    # With colors, the request line and status should contain ANSI codes\n+    assert \"POST /test?foo=bar HTTP/1.1\" in output\n+    assert \"200\" in output\n+\n+\n+def test_get_status_code_colored() -> None:\n+    \"\"\"Test get_status_code_colored method.\"\"\"\n+    formatter = GunicornAccessFormatter(use_colors=True)\n+\n+    # Test various status code ranges\n+    assert \"200\" in formatter.get_status_code_colored(200)\n+    assert \"OK\" in formatter.get_status_code_colored(200)\n+\n+    assert \"301\" in formatter.get_status_code_colored(301)\n+    assert \"Moved Permanently\" in formatter.get_status_code_colored(301)\n+\n+    assert \"404\" in formatter.get_status_code_colored(404)\n+    assert \"Not Found\" in formatter.get_status_code_colored(404)\n+\n+    assert \"500\" in formatter.get_status_code_colored(500)\n+    assert \"Internal Server Error\" in formatter.get_status_code_colored(500)\n+\n+    # Test unknown status code\n+    assert \"599\" in formatter.get_status_code_colored(599)\n+\n+\n+def test_get_status_code_colored_without_colors() -> None:\n+    \"\"\"Test get_status_code_colored without colors.\"\"\"\n+    formatter = GunicornAccessFormatter(use_colors=False)\n+    result = formatter.get_status_code_colored(200)\n+    assert result == \"200 OK\"\n+    # Should not contain ANSI escape codes\n+    assert \"\\x1b\" not in result\n"
        }
    ]
}